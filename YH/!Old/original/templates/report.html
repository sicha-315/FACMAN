<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <title>ì œì¡° ë³´ê³ ì„œ ìƒì„±</title>

  <!-- âœ… ìŠ¤íƒ€ì¼ ì‹œíŠ¸ -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='report.css') }}">

  <!-- âœ… ì°¨íŠ¸ ë° PDF ë³€í™˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>

<body>
  <!-- âœ… ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
  <nav class="sidebar">
    <div class="logo-box">
      <img src="{{ url_for('static', filename='images/facman.png') }}" alt="FACMAN Logo" class="logo-img" />
    </div>
    <h2>ğŸ“Š ëŒ€ì‹œë³´ë“œ</h2>
    <a href="{{ url_for('index') }}">ğŸ  ë©”ì¸ í˜ì´ì§€</a>
    <a href="{{ url_for('usefulness') }}">ğŸ–¥ï¸ P1-A</a>
    <a href="server_A2.html">ğŸ–¥ï¸ P1-B</a>
    <a href="server_B1.html">ğŸ–¥ï¸ P2-A</a>
    <a href="server_B2.html">ğŸ–¥ï¸ P2-B</a>
    <a href="{{ url_for('report_page') }}">ğŸ“ ë³´ê³ ì„œ ìƒì„±</a>
  </nav>

  <!-- âœ… ìƒë‹¨ í—¤ë” -->
  <header>
    <div><strong>ì œì¡° ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ</strong></div>
    <div class="header-right">
      <div class="user-icon">ğŸ‘¤ <span class="user-name">í™ê¸¸ë™(ëŒ€ë¦¬)</span></div>
      <div class="clock" id="clock">--:--:--</div>
      <div>ğŸ”” ì•Œë¦¼</div>
    </div>
  </header>

  <!-- âœ… ì „ì²´ ë ˆì´ì•„ì›ƒ ë°•ìŠ¤ -->
  <div class="layout-column">
    <div class="main-wrapper">
      <!-- âœ… ë©”ì¸ ì½˜í…ì¸  -->
      <main class="main">
        <div class="section">
          <h2>ğŸ“ ì œì¡° ë³´ê³ ì„œ ìƒì„±</h2>

          <!-- ê³µì • ë° ê¸°ê°„ ì„ íƒ -->
          <div class="search-bar">
            <label>ê³µì • ì„ íƒ:</label>
            <div id="processCheckboxes">
              <label><input type="checkbox" value="P1-A"> P1-A</label>
              <label><input type="checkbox" value="P1-B"> P1-B</label>
              <label><input type="checkbox" value="P2-A"> P2-A</label>
              <label><input type="checkbox" value="P2-B"> P2-B</label>
            </div>

            <label>ê¸°ê°„ ì„ íƒ:</label>
            <select id="periodType">
              <option value="daily">ì¼ê°„</option>
              <option value="weekly">ì£¼ê°„</option>
              <option value="monthly">ì›”ê°„</option>
            </select>

            <select id="range">
              <option value="1ì‹œê°„">1ì‹œê°„</option>
              <option value="3ì‹œê°„">3ì‹œê°„</option>
              <option value="6ì‹œê°„">6ì‹œê°„</option>
              <option value="9ì‹œê°„">9ì‹œê°„</option>
              <option value="custom">ì‚¬ìš©ì ì§€ì •</option>
            </select>

            <input type="datetime-local" id="startTime" style="display:none;">
            <input type="datetime-local" id="endTime" style="display:none;">
          </div>

          <!-- í¬í•¨ í•­ëª© -->
          <div class="search-bar">
            <label>ë³´ê³ ì„œ í¬í•¨ í•­ëª©:</label>
            <label><input type="checkbox" id="includeAvailability"> ê°€ë™ë¥ </label>
            <label><input type="checkbox" id="includeProduction"> ìƒì‚°ì‹¤ì </label>
            <label><input type="checkbox" id="includeDowntime"> ë‹¤ìš´íƒ€ì„</label>
            <label><input type="checkbox" id="includeFailureCount"> ê³ ì¥ ê±´ìˆ˜</label>
            <label><input type="checkbox" id="includeMTBF"> MTBF</label>
            <label><input type="checkbox" id="includeMTTR"> MTTR</label>
          </div>

          <!-- ğŸ“¤ ë²„íŠ¼ -->
          <div class="search-bar">
            <button onclick="generateReport()">ë³´ê³ ì„œ ìƒì„±</button>
            <button onclick="downloadDocx()">ğŸ“¥ ì¢…í•© ë³´ê³ ì„œ(.docx) ë‹¤ìš´ë¡œë“œ</button>
            <button onclick="downloadExcel()">ğŸ“Š ê¸°ì´ˆ ë°ì´í„°(.xlsx) ë‹¤ìš´ë¡œë“œ</button>
          </div>
        </div>
        
        <!-- ğŸ“„ ìƒì„±ëœ ë³´ê³ ì„œ ê²°ê³¼ -->
        <div class="section">
          <div id="reportBox">ğŸ“„ ìƒì„±ëœ ë³´ê³ ì„œ ë‚´ìš©ì´ í‘œì‹œë©ë‹ˆë‹¤.</div>
          <div id="tabs" class="tab-container"></div>
          <div id="chartsArea"></div>
        </div>
      </main>

      <!-- âœ… ì˜¤ë¥¸ìª½ ì‚¬ì´ë“œë°” -->
      <aside class="right-sidebar">
        <div class="section chatbot">
          <h2>ğŸ’¬ ì±—ë´‡</h2>
          <div id="chatHistory" class="chat-history"></div>
          <div class="chat-input-box">
            <textarea id="chatInput" placeholder="ì˜ˆ: P1-A ê°€ë™ë¥  ì•Œë ¤ì¤˜"></textarea>
            <div class="chat-buttons">
              <button id="chatSendBtn">ì§ˆë¬¸í•˜ê¸°</button>
              <button id="chatClearBtn" class="clear-btn" title="ëŒ€í™” ì´ˆê¸°í™”">ğŸ—‘ï¸</button>
            </div>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <!-- âœ… ê³µí†µ ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    function updateClock() {
      const now = new Date();
      document.getElementById("clock").textContent = now.toLocaleString('ko-KR', { hour12: false });
    }
    setInterval(updateClock, 1000);
    updateClock();

    function toggleLog() {
      const logArea = document.getElementById("logArea");
      logArea.style.display = logArea.style.display === "none" ? "block" : "none";
    }

    document.addEventListener("DOMContentLoaded", () => {
      const rangeSelect = document.getElementById("range");
      const startTime = document.getElementById("startTime");
      const endTime = document.getElementById("endTime");

      rangeSelect.addEventListener("change", function () {
        const isCustom = this.value === "custom";
        startTime.style.display = isCustom ? "inline-block" : "none";
        endTime.style.display = isCustom ? "inline-block" : "none";
      });
    });
  </script>

  <!-- ì±—ë´‡ JS íŒŒì¼ -->
  <script src="{{ url_for('static', filename='js/chat_langgraph.js') }}"></script>
  
  <!-- âœ… ë³´ê³ ì„œ ê¸°ëŠ¥ ìŠ¤í¬ë¦½íŠ¸ -->
  <script src="{{ url_for('static', filename='js/report.js') }}"></script>
  
</body>

</html>
